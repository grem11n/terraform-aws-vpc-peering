// Module
module "single-account-single-region" {
  source = "../../"

  providers = {
    aws.this = "aws"
    aws.peer = "aws"
  }

  this_vpc_id = "${aws_vpc.this.id}"
  peer_vpc_id = "${aws_vpc.peer.id}"

  // Do no compute route tables, but pass IDs
  this_vpc_rts = "${aws_route_table.this.*.id}"
  peer_vpc_rts = "${aws_route_table.peer.*.id}"

  create_peering      = true
  auto_accept_peering = true
  depends_on          = "${concat(aws_vpc.this.id, aws_vpc.peer.id, aws_route_table.this.*.id, aws_route_table.peer.*.id, aws_subnet.this.*.id, aws_subnet.peer.*.id)}"

  tags = {
    Name        = "tf-single-account-single-region"
    Environment = "Test"
  }
}
